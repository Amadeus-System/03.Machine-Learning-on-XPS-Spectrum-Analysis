# 03.Machine-learning-on-XPS-spectrum
Repository for my undergraduate paper for Machine learning analysis of XPS spectrum


**[계속 수정중인 글입니다.]**
  
# 글을 시작하며

이번 포스팅에서는, 내가 학부졸업을 유예하고 한 학기 동안 지금의 연구실에서 외부협력연구원으로 연구했었던 XPS 스펙트럼 분석에 관해 소개하고자 한다.

**사실 냉정히 말해서 이 연구는 망한 연구이다.** 국문으로 쓰여진 논문들을 무시하는 것은 아니지만, 결코 높은 수준의 논문이라고 말할 수 없고, 실제로도 연구결과가 좋지 않았다.

당시의 나는 졸업논문을 위한 연구를 한 번 해본 경험이 전부였기 때문에, 이 경험은 공식적으로 기록을 남기는 최초의 연구경험이라고 할 수 있었다. 연구가 진행되는 동안 낯선 분야인 XPS와 관련된 많은 논문을 읽었고, 더 깊은 수준의 프로그래밍을 경험할 수 있었다. 유명한 딥러닝 프레임워크인 Tensorflow가 이 당시에는 버전 1으로 있었는데, 텐서플로우 버전 1은 요즘 자주 쓰이는 버전 2에 비해 조금 더 문법적으로 어려웠다. 그래서 나는 Keras라는 High-level Interface를 사용했는데, 하나의 딥러닝 프레임워크를 6개월 동안 몰입해서 사용한 경험은 확실히 내 실력을 한층 성장시켜주었다.

그러한 경험을 이번 포스팅에서 간단히 소개하고자 한다.


# Deep Learning Applied to Peak Fitting of Spectroscopic Data in Frequency Domain

![XPS_PHYSICS](https://user-images.githubusercontent.com/76824867/159117886-4eeac17d-02d2-433d-84d1-87a98c37b669.png)


## Abstract

2016년 알파고와 이세돌의 기념비적인 대국 이후로, 학계 및 산업계 전반에서도 인공지능이나 데이터 사이언스와 같은 신기술을 이용하여 각 분야에서 급격한 기술발전을 이루려는 움직임이 나타났다. 

특히 물리학과 화학, 그리고 재료공학과 같이 물질의 특성을 연구하고 유용한 신물질을 탐색하는 것을 주 연구주제로 하는 분야에서도, 그 동안 축적된 실험데이터와 딥러닝 기술을 이용하여 보다 효과적인 연구를 수행하고자 했다.

이를 위해 필수적인 요소 중 하나는 바로 대량의 실험적 분광학 데이터와 제일원리 전자구조계산 결과들이었다. 이러한 대규모 데이터와 딥러닝 모델이 결합함으로써, 최소한의 인간의 개입만으로 (즉, 최소한의 도메인 지식만으로) 방대한 물질조합에 대한 특성 추출을 자동화할 수 있는 High-Throughput Material Screening 이라는 연구분야가 확대되기 시작했다.

이러한 작업의 특수한 케이스로, 1차원 진동수(Frequency) 영역에서의 광전자분광학(Photoemission Spectroscopy, PES) 실험결과들을 입력받아, 이로부터 전자의 여기에너지, 여기 상태의 수와 각 PES Peak의 에너지 폭을 얻어내는 딥러닝 모델을 만들고 그 성능을 테스트하는 연구를 시도했었다. 

즉, XPS라는 특정한 실험물리학 분야에 대해 대규모 물질 스크리닝 작업을 가능케하는 딥러닝 모델을 구현하고자 하였다.

딥러닝 모델링 과정에서는 1차원 합성곱 신경망(Convolutional Neural Network, CNN)가 사용되었고, 훈련된 모델은 Poly(3-hexylthiophene) (P3HT) 분자 안의 황의 2p 상태 및 인듐 주석 산화물 내 산소의 1s 상태로부터의 PES 스펙트럼을 분석하는데 사용되었다. 

---

## 1. 서론

### XPS란 무엇일까?

연구에 대해 설명하기 전에 먼저 XPS가 무엇인지 설명해야 할 것 같다.

광전자분광학(X-ray Photoelectron Spectroscopy, XPS)는 기본적으로 물질의 표면특성을 실험적으로 조사하기 위한 방법론이다.

![XPS Configuration](https://user-images.githubusercontent.com/76824867/159118641-c818f2b5-5edb-4825-9486-f6e48ac5b249.png)

위 그림과 같이 높은 에너지를 갖는 전자기파를 물질의 표면에 조사하면, 물질 표면의 원자와 전자의 결합이 깨지면서 표면 밖으로 탈출하는 전자가 발생할 수 있다. 물리학에서는 이를 광전효과(Photoelectric Effect)라 한다. 이 때 표면 밖으로 나오는 전자는 빛(전자기파)에 의해 여기된(Excited) 상태이기 때문에, 물질 내부의 전자보다 더 높은 에너지를 갖고 있고 이를 Photoelectron(광전자)이라 한다. XPS 실험에서는 이러한 광전자를 특수한 Detector가 감지하여 시간당 방출되는 전자의 수를 측정함으로써, 물질 표면에 어떠한 결합이 존재하고 있었는가에 대한 다양한 정보를 얻을 수 있게 된다.

![Energy Relations](https://user-images.githubusercontent.com/76824867/159118647-197b26b2-62f1-4ba9-aab5-3853bf7d33ea.png)

위 그림을 보면 알 수 있듯이, 본래 물질 표면의 전자들은 대부분 안정된 에너지 상태로 결합되어 있다. 그러나 외부에서 전자기파의 형태로 에너지가 들어오면, 일부 전자들은 그 에너지를 받아 원자로부터의 속박을 끊고 물질 밖으로 탈출할 수 있게 된다. 보통 XPS 실험에서 알고자 하는 것은 물질 표면에 속박되어 있던 전자의 결합에너지(Binding Energy)이다.

외부에서 전자기파의 형태로 투입되는 에너지의 양은 아인슈타인의 광전효과 이론에 의해 $E = hf$ 형태로 주어진다. 우리는 실험장비를 통해 전자기파를 발생시키는 Source의 종류와 진동수(Frequency)를 이미 알고 있기 때문에, 전자기파의 에너지는 이미 알고 있는 정보가 된다. 그리고 입자의 운동에너지(Kinetic Energy)는 물질 밖에서 대기 중인 감지기(Detector)에 의해 측정된다. 나는 XPS를 전문적으로 연구하지 않기 때문에 잘 모르지만, 일반적으로 감지된 광전자를 전류로 환원시켜 광전류의 세기를 측정함으로써 간접적으로 시간당 방출되는 광전자의 수를 측정할 수 있다고 알고 있다. 결과적으로 광전자의 운동에너지에 대한 정보도 알 수 있기 때문에, 위 수식에서 보이는 것처럼 $E_{binding} = h\nu - E_{kinetic}$으로 결합에너지는 (전자기파의 에너지 - 운동에너지)가 되어 우리는 원래는 몰랐던 물질 표면의 결합에너지를 XPS 실험을 통해 알 수 있게 된다.

![XPS Spectrum](https://user-images.githubusercontent.com/76824867/159118649-6bd929c5-c43c-456b-8955-47128cf57233.png)

XPS 실험의 결과는 보통 위 그림과 같은 스펙트럼의 형태로 얻어지는데, 스펙트럼 그래프를 보면 다양한 전자의 Binding Energy 또는 Kinetic Energy 레벨에 따른 전자의 Intensity (시간당 방출되는 광전자 수)를 얻을 수 있다. 여기서 중요한 것은 어떤 에너지 레벨에서 특정한 Peak가 존재하는가를 판별하는 것이다. 위 그림에서 보면 다양한 Peak 위치에서 특정한 종류의 원자의 특정한 오비탈(Orbital, 전자의 파동함수) 결합이 있었음이 표시되어 있다. 표면실험을 전문으로 하지 않아서 잘 모르지만, 관련분야 대학원생의 말을 들어보면, 저 Peak와 관련된 정보를 잘 추출해내어 분석하는 것이 중요하다고 한다.

그리고 당시에 교수님께서 내게 주셨던 것은 바로.. 그러한 1차원 스펙트럼 데이터를 딥러닝 모델로 학습시켜, 스펙트럼 데이터에서 일반적으로 얻어져야 하는 Energy Peak에 관한 여러 정보를 추출하는 것이었다. 즉, 우리가 어떤 딥러닝 모델 F를 갖고 있다면, 그것은 아래와 같이 주어진 Spectrum 그래프에 대하여 여러 종류의 단일 Peak 그래프로 분해(Decomposition)해야 한다. 즉, 일종의 Fitting 문제를 풀어야 한다.

![Objective](https://user-images.githubusercontent.com/76824867/159118650-61353016-8abb-4f3e-b27c-a6c219328a37.png)

사실 연구 초기에 이 문제는 어려울 것이라 생각했다. 왜냐하면 일단 그래프를 Fitting한다는 것은, 결국 특정한 포인트 또는 영역에서 Y 값의 분해를 한다는 뜻인데, 여러 Y 값들이 있을 때 그것을 합치는 것은 일방통행적인 연산이지만, 그 역연산은 마치 중학교때 배웠던 부정방정식을 푸는 것과 같아서, 답이 여러가지이기 때문이다.

물론, 실제로는 아주 불가능한 것은 아니고, XPS 데이터가 Fitting되는 어느정도 전형적인 상황들이 있었기 때문에, 그러한 상황들을 단서조건으로 달고 딥러닝 모델을 학습시킬 수는 있었다. 그리고 사실 테스트 데이터까지는 아주 결과가 나쁜 것도 아니었다.

다음 결과들은 연구 초기에 간단히 만들었던 딥러닝 모델이 Synthetic XPS 데이터로 학습되었을 때, 일부 Convolution 레이어의 1차원 필터와 Input의 변화를 시각화한 것이다.

![1st Filter Visualization](https://user-images.githubusercontent.com/76824867/159118651-35f9f178-1d0e-46e1-b5d2-5ac6bfb8a9aa.png)
![Result of 1st layer](https://user-images.githubusercontent.com/76824867/159118652-6655cf7c-da72-436f-ab79-4cd5ab1fb132.png)
![2nd Filter Visualization](https://user-images.githubusercontent.com/76824867/159118654-eeab7aaf-70d9-4e8c-95cf-e5acb6f269ab.png)
![Result of 2nd layer](https://user-images.githubusercontent.com/76824867/159118655-f6592e21-41f7-4abd-9a95-075118765774.png)

특정한 필터에서 Input Signal의 일부 Peak 정보들이 계산되고 있음을 어느정도 추측할 수 있었다. 그리고 사실 이 단계에서는 꽤나 연구가 잘 될 것이라 믿었다.


## 본론 : 계산 방법론, 결과 및 논의

### 1. 계산 방법론 및 도구

실제 연구에서는 신경망 모델링과 학습을 위해 고수준 딥러닝 라이브러리인 Keras 프레임워크를 사용하였다. Keras는 Tensorflow Backend 위에서 작동하는 딥러닝 프레임워크로 딥러닝 프로젝트에서 자주 하게 되는 고차원의 텐서연산 및 신경망 모델생성, 학습을 쉽게 수행할 수 있게 해준다. 초기 단계에서의 연구는 Google에서 무료로 제공되는 Colab 환경을 이용하였지만, 이후 연구가 진행되면서 계산량이 많아져서 연구실에서 자체적으로 보유한 Work Station 서버를 활용하게 되었다.

ITO 및 P3HT의 X선 PES 실험을 위해서는 K-Alpha+ (Thermo Fisher Scientific Co.) 시스템을 사용하였으며, 코어 레벨 스펙트럼을 얻기 위해 Al K$\alpha$ X선 광원이 ($h\nu$ = 1486.6 eV) 사용되었다.

![Fig. 1.](https://user-images.githubusercontent.com/76824867/149633934-91db6300-5fac-448e-a8df-5e6867e83487.png)

위 그림(a)는 3종류의 Pseudo-Voigt Peaks로 구성된 Synthetic Training 데이터셋의 예시를 보여준다. 빨강색, 파랑색, 초록색의 점선들은 각각의 Pseudo-Voigt peak와 noise가 섞인 신호를 의미한다. 검정색 실선은 모든 신호의 합이다. 그림(b)는 3개의 Synthetic Training Signal을 보여준다.


### 2. 모델 훈련을 위한 인공 데이터 생성

인공 신경망 학습에 요구되는 막대한 양의 데이터에 비해서, 실제 XPS 실험에서 얻을 수 있는 데이터의 양에는 한계가 있었다. 따라서, 본 연구에 있어서 가장 먼저 요구되는 것은 신경망의 학습을 위한 대규모 훈련 데이터의 생성이었다. 이를 위해서, X선 회절 또는 PES에서의 개개의 여기 Peak를 Fitting하는데 널리 사용되는 유사 Voigt 함수를 사용하였으며, 실제 에너지 피크를 생성하는데 사용한 함수는 다음과 같았다.

$$ f(\omega; \omega\_{0}, I_{0}, w) = 0.7 e^{-\frac {w_{G}^{2} (\omega - \omega_{0})^{2}} {w^{2}}} + 0.3 \frac {1} {1 + \frac {w_{L}^{2} (\omega - \omega_{0})^{2}} {w^{2}} } $$

위 식에서 $\omega$는 진동수이고, $w_{G}$ = 1.634, $w_{L}$ = 2.195로 고정되었다. 

따라서 위 식에 의해 만들어지는 피크는 최대 세기 $I_{0}$, 피크의 폭을 나타내는 단일 변수 $w$, 그리고 피크의 위치인 $\omega_{0}$ 3개의 변수로 나타낼 수 있으며, 일정 구간 내에서 이 3개의 변수를 무작위로 생성하여 피크가 생성되었다.

이 때, 실제 실험에서 발생할 수 있는 피크 모양의 좌우 비대칭성은 고려하지 않았다. 개개의 훈련 데이터는 진동수 구간 내에서 최대 13개의 피크를 가지고, 피크의 개수 또한 무작위가 되도록 설정되었다. 마지막으로, $I_{0}$의 최대 5% 정도의 노이즈를 더하여 실제 실험에서 발생하는 노이즈 효과를 모방하였다.

다만, 실제 측정에서 발생할 수 있는 배경(Background Signal) 값은 무시하였다. 배경값을 포함한 1차원 진동수 영역에서의 신호 처리 또한 CNN 방법론을 통해 효과적으로 수행될 수 있음이 밝혀져 있었기 때문에, 이에 대해서는 고민하지 않고 넘어갈 수 있었다.

학습을 위하여 진동수 $\omega$는 $\omega_{i} (0 \le i \le 400)$ 의 값들로 이산화되어, 기계학습을 위해 입력되는 데이터는 ${f_n(w_i)}$ 의 벡터로서 표현될 수 있었다. ($1 \le n \le N$, $N$은 학습 데이터셋 내 데이터 총 수)


### 3. 학습을 위한 심층 신경망 모델 구조 설정 및 훈련

다음 단계로서, 훈련의 대상이 되는 신경망의 구조를 설정해야 했다. 심층 신경망 모델 중 CNN이 사진이나 동영상 등 2차원 화상의 특성 추출에 매우 뛰어난 성능을 보인다는 점에 착안하여, 연구에서는 PES 스펙트럼을 1차원 데이터로 간주하고 신경망 모델의 데이터 입력 부분에 여러 겹의 CNN 배열을 적용하였다. 

신경망의 앞 부분에는 Conv1D (1차원 합성곱) 및 MaxPooling1D (데이터 크기를 $\frac {1}{2}$로 줄이는 다운샘플링) 층이 3중으로 배치되어 입력 데이터의 차원을 효과적으로 축소하는 한 편 적절한 깊이의 특성 추출이 효과적으로 이루어질 수 있도록 하였다.

다음 단계로서 GlobalMaxPooling1D(전역적 맥스풀링) 층을 사용하여 추출된 특성값들을 1차원 벡터로서 변환 후, 해당 특성값 벡터를 입력받아 원하는 4종류의 목표변수인 스펙트럼 내 피크 수, 각 피크의 세기 $I_{0}$, 중심 위치 $\omega_{0}$, 그리고 에너지 폭 $w$을 추출 및 출력하는 FCL 층 4개를 연결하였다.

여기에서 스펙트럼 내 피크 수 및 각 피크의 중심 위치들은 나머지 변수들을 예측하는데 필요한 정보이기 때문에, 이 두 값들은 먼저 추출되어 각 피크 세기와 에너지 폭을 추출해내는 FCL 층의 입력값으로 Batch Normalization 층을 거쳐 제공되도록 하였다.

모든 층에서의 활성화 함수는 ReLU (Rectified Linear Unit) 함수를 사용하였다. 참고로, 본 연구에서는 피크의 수가 최대 3개인 데이터들을 생성하여 모델을 훈련하였으며, 피크 수가 이보다 작은 데이터의 경우 목표 변수들의 값들이 피크 수 만큼만 예측되고 나머지는 0으로 출력되도록 모델을 학습하였다.

![Fig. 2.](https://user-images.githubusercontent.com/76824867/149633995-d903fc9a-4d99-4afc-8cb3-cd95c53c5aba.png)

모델 훈련을 위한 총 입력 데이터 수는 2천만개, 그리고 학습을 위한 에포크 수는 200개로 조정하였으며, 모델 가중치 최적화를 위해서는 Adam 알고리즘을 사용하였다.

또한 학습과정에서의 과대적합(Overfitting)을 방지하기 위해, 학습 과정에서 과대적합이 일정한 에포크 이상으로 지속적으로 발생할 경우 학습률(learning rate)를 감소시키는 장치 및 항상 최적의 손실함수 감소를 보인 상태에 대해서만 신경망 모델을 저장하는 장치를 콜백 함수를 통해 삽입하였다.

대부분의 딥러닝 프로젝트에서 Classification(분류) 문제를 다루는 것과 달리, 우리의 연구는 특정한 Target 값에 치밀하게 근접하도록 학습해야 하는 Regression(회귀) 문제상황이었기 때문에 모델의 학습과정에서 더 세심한 조정이 필요했다.

특히 과대적합(Overfitting)이 매우 잘 발생하였는데, 이는 XPS 스펙트럼의 정보를 효과적으로 추출하기 위한 설계과정에서 증가하는 파라미터의 수와 모델의 학습과정이 충돌하였기 때문이다.

이를 해결하기 위해 유사한 성능을 보이는 여러 모델들 중에서 가장 간단한 구조를 갖는 신경망 모델을 선정하였다. 그리고 Regularization, Batch Normalization, Dropout 등의 여러 수단을 통해 모델의 과대적합을 억제하고 올바른 방식으로 손실함수가 감소되게 하였다. 최종적으로 학습된 모델의 총 학습가능한 가중치 파라미터의 수는 약 17만 3천개였다.

![Fig. 3.](https://user-images.githubusercontent.com/76824867/149634029-63777d95-560c-4bb4-a155-0958347a7c1a.png)


### 4. 훈련된 모델의 시험 데이터 적용 결과

다음 그림은 훈련을 마친 모델에 테스트 데이터셋을 적용한 결과들이다. 

결과 중 위쪽 2개 및 왼쪽 아래 패널은 2개의 피크로 이루어진 테스트 데이터를 사용한 결과이며, 오른쪽 아래 패널은 피크 3개로 이루어진 테스트 데이터에서 나온 결과이다. 

위 4개의 결과에서 확인할 수 있듯이, 무작위로 생성된 테스트 데이터셋에 대해서 상기한 훈련된 모델이 잘 작동하여 비교적 좋은 피팅 결과를 이끌어내는 것을 볼 수 있다. 물론, 이는 피크의 위치 및 대략적인 세기를 입력 후 회귀 분석을 통해 이끌어 낸 결과들에 비해서는 정확도가 떨어진다고 할 수 있으나, 인간의 개입 및 배경지식 없이 기계학습된 모델만을 사용한 결과로서는 인상적이라 할 수 있다. 

특히, 그림의 오른쪽 위 패널의 경우, 두 개의 피크 중심이 상당히 가깝게 위치해 있는데다 하나의 피크의 세기가 약한 어려운 데이터임에도 불구하고 두 개의 피크의 위치 및 세기를 잘 잡아내는 것을 확인할 수 있다.

![그림4](https://user-images.githubusercontent.com/76824867/149634051-8c21049a-df45-498d-bb7f-d5a0afe52070.png)

참고로, 피크의 개수가 하나로 고정된 경우에는, CNN 없이 FCL 층만을 통해 신경망 모델을 구성하더라도 매우 정확한 결과를 얻을 수 있었다. 그런 경우에는 XPS 스펙트럼이 매우 단순한 구조이기 때문에 당연한 결과였다.

하지만 피크의 개수가 2개 이상으로 주어지며 Overlapping Area가 발생되고, 또한 노이즈가 섞여 있는 결과들에 대해서는, 유사한 최적화 가능 가중치 변수 숫자를 갖춘 모델들을 비교했을 때 CNN + FCL 층의 조합이 FCL 만으로 구성된 모델에 비해 보다 나은 성능을 보여주는 것을 확인할 수 있었다. 이는 노이즈 처리 및 신호의 국소적 특성 추출에 유리한 CNN 층의 장점이 나타난 결과로 해석되었다.


### 5. 훈련된 모델의 실제 광전자분광학 데이터 적용 결과

최종적으로, 학습된 모델을 ITO 기판 위에서 증착된 P3HT 분자들 및 ITO 기판 자체에 대한 코어레벨 X선 PES (XPS) 스펙트럼 측정 결과에 적용해보았다.

다음 그림의 (a), (b)는 각각 P3HT 분자들의 S 2p 및 ITO 기판 자체의 O 1s 코어레벨 XPS 측정결과를 나타내고, 각각의 그림에서 빨강색, 파랑색 및 초록색 커브들은 IGOR PRO 패키지를 이용하여 피팅된 피크들을 나타낸다.

분석을 용이하게 하기 위해, 측정된 스펙트럼에서 배경신호를 제거하였고 스펙트럼의 최대값이 1이 되도록 데이터를 재규격화하였다.

![그림5](https://user-images.githubusercontent.com/76824867/149634055-47279a3c-a03c-4c61-92a7-d11564a4a660.png)

<br>

밑의 그림은 P3HT에서 측정된 XPS 스펙트럼 및 IGOR PRO 패키지 피팅으로 얻은 각 피크 커브들을 위 과정을 통해 얻은 신경망 모델의 결과들과 비교한 것이다.

(a)는 배경신호를 제거한 실험결과(회색 선)를 신경망 모델에 의해 얻어진 피크들의 합(검은색)과 비교하고 있으며, 이 두 결과가 상대적으로 잘 일치함을 보여주고 있다.

(b)는 실험결과로부터 IGOR PRO 패키지 피팅으로 얻어낸 황의 2$p_{1/2}$ (어두운 파란색 선) 및 2$p_{3/2}$ (어두운 빨간색) 피크들과 신경망 모델이 얻어낸 피크들을 (밝은 파랑색 및 빨강색) 비교하고 있다. 이를 통해 P3HT에서는 각 피크의 위치, 세기, 그리고 피크들의 폭을 신경망 모델이 비교적 잘 예측하고 있음을 알 수 있다.

이는 P3HT에서는 S 2$p\_{1/2}$ 와 2$p\_{3/2}$ 상태 사이의 에너지 차이가 (~ 1.2 eV) 피크의 폭보다 충분히 큰 것으로 알려져 있기 때문에, 두 피크가 비교적 잘 구분되고 있기 때문으로 추정된다.

![그림6](https://user-images.githubusercontent.com/76824867/149634059-fdf8a1fc-8640-4418-bce9-60d3903c162e.png)

마지막으로 다음 그림은 ITO에서 측정된 XPS 스펙트럼과 IGOR PRO 패키지 피팅을 통해 얻은 각 피크 곡선들을 신경망의 예측 결과와 비교하여 보여주고 있다.

마지막으로 밑의 그림은 ITO에서 측정된 XPS 스펙트럼 및 IGOR PRO 패키지 피팅을 통해 얻은 각 피크 커브들을 신경망 모델 예측 결과들과 비교하여 보여주고 있다. 

Figure 5(b)에서 보여진 것처럼, ITO 표면에 존재하는 산소 결핍 및 수소 결합의 존재는 서로 다른 3개의 산소 1$s$ 여기 상태 피크를 만들어낸다. 단, Fig. 7(a) 및 5(b)에서 확인할 수 있듯이, P3HT의 경우와는 달리 각 피크들의 폭에 비해 피크들 사이의 에너지 차이가 크지 않아 서로 다른 피크들이 충분히 잘 구분되지 않으며, 이 때문에 신경망 모델이 전체 스펙트럼으로부터 서로 다른 피크들을 분리해내는 것에 어려움이 있을 수 있음을 예상할 수 있다. 

Figure 7(b)는 IGOR PRO 패키지 피팅 결과 및 신경망 모델이 도출한 결과들을 비교하고 있으며, 위에서 예상한 바와 같이 신경망 모델이 각 피크의 위치 및 세기를 잘 도출해내고 있지 못함을 확인할 수 있다. 

특히, 530.29 eV에 위치한 첫번째 피크를 (어두운 빨강색), 신경망 모델은 서로 다른 2개의 근접한 피크들의 (밝은 보라색 및 빨강색) 합으로 잘못 해석하고 있으며, 대신 532.8 eV에 위치한 세번째 피크의 존재를 (어두운 초록색) 신경망 모델이 놓치고 있는 것을 확인할 수 있다.

![그림7](https://user-images.githubusercontent.com/76824867/149634060-9e621dfa-b345-41bc-9e1a-13bb467cf5e6.png)![표1](https://user-images.githubusercontent.com/76824867/149634339-b4fbda9c-ae10-413d-9f74-e6f8cd813673.PNG)

Table 1은 신경망 모델에서 얻어낸 파라미터들을 연구자가 패키지 피팅을 통해 얻은 결과들과 비교하고 있으며, 현재 사용한 초보적인 수준의 신경망 모델에 개선의 여지가 아직 많이 남아있음을 보여주고 있다.

## 글을 마치며

이 연구 프로젝트를 통해 딥러닝 모델을 물리학 문제 및 실험결과의 분석에 적용하는 것의 가능성에 대해 확인할 수 있었지만, 실제 연구를 위한 도구로 활용되기 위해서는 보다 심도있는 모델링과 파라미터 튜닝, 그리고 더 많은 양의 훈련 데이터가 필요했다.

특히 XPS 분야에서 비선형 회귀분석 방법론을 통해 1차원 분광학 데이터를 피크 피팅하는 것은 이미 잘 발전되어 있기 때문에, 이에 대해 정량적인 정확도의 우위를 점하기 위해서는 더 많은 노력이 필요했다.

이 연구 프로젝트와 상당히 유사하지만, 더 복잡한 피크 피팅과 물질 내 원소의 구성비 예측을 목표로 한 선행연구가 있었는데, 그 연구에서는 기계학습 모델을 통해 예측된 물질의 조성비가 실제 측정결과와 비교하여 10% 수준의 큰 오차를 보이는 것을 확인할 수 있었다.

아마도 이런 오차의 주된 원인으로는 모델 훈련을 위해 가상의 분광학 데이터를 생성해야 하는 어려움이 가장 클 것이다. 하지만 기계학습 문제의 관점에서 보자면, 어느 정도의 오차가 허용되는 분류 문제가 아닌 정량적 수치를 밀접하게 예측해야 하는 Regression 문제에 접근하는 것의 어려움을 엿볼 수 있었다.

다만, 2018년에 발표되어 주목을 받은 CGCNN 연구의 사례처럼, 학습 데이터를 기계학습에 적합한 형태로 변환할 수 있을 때 물질의 전체 에너지와 같은 정량적인 값 또한 상당히 높은 정밀도로 예측가능한 사례가 있었다. 결국 신경망 모델의 학습 뿐만 아니라, 적절한 데이터의 표현형을 찾는 것도 중요한 문제임을 알 수 있었다.

그리고, 이번 연구와 같이 1차원 스펙트럼 데이터에 대한 기계학습 방법론 접근은, 사람에게도 비교적 쉬운 문제에 해당되기 때문에 딥러닝 모델을 활용하는 것이 대단한 이득이 없을 수도 있었다. 그러나 당시 교수님의 큰 그림은.. 분광학 데이터 도메인의 차원이 2차원 이상으로 확장되는 (진동수 + 운동량) 차원에서 각분해 광전자 분광학 (Angle-Resolved PES, ARPES) 데이터를 분석하는데 딥러닝 모델이 유용한가를 판별하는 것이 진정한 목적이었기 때문에, 이 연구는 사실 진짜 연구의 예비단계에 해당하는 연구였다.

참고로, 이후 이 연구의 후속연구로서 모델의 정확도 및 성능을 개선한 연구가 나름대로 성공하여 JKPS에 게재되었다. 그 연구는 나중에 소개하도록 하겠다. 참고로 이 연구가 본래 계획의 1단계였고, 후속연구가 2단계였는데... 진정한 연구였던 3단계는 나와 다른 연구원이 모두 재미없다고 포기해서 시작조차 되지 않았다. ㅋㅋㅋㅋ

## Reference

